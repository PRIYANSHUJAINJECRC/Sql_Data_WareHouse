############################################################
# ðŸ“Œ Purpose of this Script
############################################################
This SQL script creates **Silver Layer tables** inside the `DataWareHouse` 
database for storing cleaned and standardized data coming from the 
**Bronze Layer** (raw ingestion).

Each table represents a cleaned version of CRM and ERP data sources, 
and includes a `dwh_create_date` column to capture when the record 
was inserted into the warehouse.

---

### Tables Created

1. **silver.crm_cust_info**
   - Stores customer details (ID, keys, names, gender, marital status, etc.)
   - Ensures data is standardized for downstream analysis.

2. **silver.crm_prd_info**
   - Stores product details (ID, key, name, cost, product line, validity dates).
   - Used for building product dimension in reporting.

3. **silver.crm_sales_details**
   - Stores sales transaction details (order number, product, customer, 
     dates, sales amount, quantity, price).
   - Acts as a fact table for sales analysis.

4. **silver.erp_CUST_AZ12**
   - Stores ERP customer information (ID, birthdate, gender).
   - Standardizes ERP customer data for integration with CRM.

5. **silver.erp_LOC_A101**
   - Stores ERP customer location details (ID, country).
   - Cleans up inconsistent country codes/names.

6. **silver.erp_PX_CAT_G1V2**
   - Stores ERP product category and subcategory information.
   - Maintains product hierarchy for reporting.

---

âœ… In short:  
This script **creates the Silver Layer schema** where raw Bronze data 
is transformed into **clean, business-ready datasets** for reporting 
and analytics.
############################################################
#  SQL CAMMANDS
############################################################

use DataWareHouse;
create table silver.crm_cust_info(
cst_id INT,cst_key NVARCHAR(50),cst_firstname NVARCHAR(50),
cst_lastname NVARCHAR(50),cst_marital_status NVARCHAR(10),cst_gndr NVARCHAR(10),cst_create_date DATE,dwh_create_date DATETIME2 default getdate()
);
create table silver.crm_prd_info(
prd_id INT,prd_key NVARCHAR(50),prd_nm NVARCHAR(50),
prd_cost INT,prd_line NVARCHAR(10),prd_start_dt DATE,prd_end_dt DATE,dwh_create_date DATETIME2 default getdate()
);
create table silver.crm_sales_details(sal_ord_num NVARCHAR(50),sls_prd_key NVARCHAR(50),sls_cust_id INT,slr_order_dt INT,sls_ship_dt INT,sls_due_dt INT,sls_sales INT,sls_quantity INT,sls_price INT,dwh_create_date DATETIME2 default getdate());
--tables for erp 
create table silver.erp_CUST_AZ12(CID NVARCHAR(50),BDATE DATE,GEN NVARCHAR(10),dwh_create_date DATETIME2 default getdate());
create table silver.erp_LOC_A101(CID NVARCHAR(50),CNTRY NVARCHAR(50),dwh_create_date DATETIME2 default getdate());
create table silver.erp_PX_CAT_G1V2(ID NVARCHAR(50),CAT NVARCHAR(50),SUBCAT NVARCHAR(50),MAINTENANCE NVARCHAR(50),dwh_create_date DATETIME2 default getdate());
